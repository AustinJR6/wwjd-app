# Project Map
_Generated: 2025-08-15T21:58:38.422Z_

This file is auto-generated by `scripts/generate-project-map.mjs`. Commit it so collaborators (and chat assistants) see the exact current shape of the project.

---

## Repo Trees (trimmed)
### functions/src
```
functions/src/
├─ core/
│  functions/src/core/
│  ├─ auth.ts
│  ├─ env.ts
│  ├─ errors.ts
│  ├─ http.ts
│  └─ logger.ts
├─ data/
│  functions/src/data/
│  └─ firestore.ts
├─ features/
│  functions/src/features/
│  └─ users/
│     functions/src/features/users/
│     ├─ controller.ts
│     ├─ index.ts
│     ├─ repo.ts
│     ├─ service.ts
│     ├─ types.ts
│     └─ validators.ts
├─ challengeHandlers.ts
├─ index.ts
├─ journalHandlers.ts
├─ orgHandlers.ts
├─ stripeHandlers.ts
└─ utils.ts
```
### functions
```
functions/
├─ scripts/
│  functions/scripts/
│  └─ emit-endpoints.ts
├─ src/
│  functions/src/
│  ├─ core/
│  │  functions/src/core/
│  │  ├─ auth.ts
│  │  ├─ env.ts
│  │  ├─ errors.ts
│  │  ├─ http.ts
│  │  └─ logger.ts
│  ├─ data/
│  │  functions/src/data/
│  │  └─ firestore.ts
│  ├─ features/
│  │  functions/src/features/
│  │  └─ users/
│  │     functions/src/features/users/
│  ├─ challengeHandlers.ts
│  ├─ index.ts
│  ├─ journalHandlers.ts
│  ├─ orgHandlers.ts
│  ├─ stripeHandlers.ts
│  └─ utils.ts
├─ addReligionPrompts.ts
├─ cleanLegacySubscriptionFields.ts
├─ codexPrompts.ts
├─ firebase.ts
├─ firestore.indexes.json
├─ firestoreArchitecture.ts
├─ firestoreSeeder.ts
├─ geminiUtils.ts
├─ helpers.ts
├─ package-lock.json
├─ package.json
├─ seedRegions.ts
├─ seedReligionFields.ts
├─ stripeWebhooks.ts
├─ tsconfig.json
└─ types.ts
```

---

## Cloud Functions Endpoints (exported `onRequest`/`onCall`)
- `updateStreakAndXP` — functions/src/features/users/controller.ts
- `getUserProfile` — functions/src/features/users/controller.ts
- `seedFirestore` — functions/src/features/users/controller.ts
- `backfillUserProfiles` — functions/src/features/users/controller.ts
- `updateUserProfileCallable` — functions/src/features/users/controller.ts
- `completeSignupAndProfile` — functions/src/features/users/controller.ts
- `createStripeSetupIntent` — functions/src/stripeHandlers.ts
- `finalizePaymentIntent` — functions/src/stripeHandlers.ts
- `createTokenPurchaseSheet` — functions/src/stripeHandlers.ts
- `createSubscriptionSession` — functions/src/stripeHandlers.ts

---

## Environment Variables referenced in `functions/src`
- `APP_BASE_URL`
- `FRONTEND_URL`
- `STRIPE_100_TOKEN_PRICE_ID`
- `STRIPE_20_TOKEN_PRICE_ID`
- `STRIPE_50_TOKEN_PRICE_ID`
- `STRIPE_CANCEL_URL`
- `STRIPE_PUBLISHABLE_KEY`
- `STRIPE_SECRET_KEY`
- `STRIPE_SUB_PRICE_ID`
- `STRIPE_SUCCESS_URL`

---

## TypeScript Path Aliases
### Root tsconfig paths
- `@/*` → ["./App/*"]

### Functions tsconfig paths
- `@core/*` → ["core/*"]
- `@data/*` → ["data/*"]
- `@features/*` → ["features/*"]
- `@utils` → ["utils"]


---

## Dependencies
### Root package.json
**dependencies**
- @expo-google-fonts/merriweather
- @expo-google-fonts/poppins
- @expo/metro-runtime
- @google/generative-ai
- @react-native-async-storage/async-storage
- @react-native-community/datetimepicker
- @react-native-picker/picker
- @react-navigation/bottom-tabs
- @react-navigation/native
- @react-navigation/native-stack
- @sentry/react-native
- @stripe/stripe-react-native
- axios
- expo
- expo-build-properties
- expo-constants
- expo-dev-client
- expo-file-system
- expo-font
- expo-image-picker
- expo-linear-gradient
- expo-local-authentication
- expo-notifications
- expo-secure-store
- expo-system-ui
- expo-updates
- expo-web-browser
- firebase
- jest
- react
- react-dom
- react-native
- react-native-calendars
- react-native-gesture-handler
- react-native-reanimated
- react-native-safe-area-context
- react-native-screens
- zustand

**devDependencies**
- @babel/core
- @expo/metro-config
- @types/axios
- @types/jest
- @types/react
- @typescript-eslint/eslint-plugin
- @typescript-eslint/parser
- babel-plugin-module-resolver
- eslint
- eslint-config-expo
- eslint-plugin-react
- jest
- metro
- rimraf
- ts-jest
- typescript

### App package.json
**dependencies**
_none_

**devDependencies**
_none_

### Functions package.json
**dependencies**
- @google-cloud/secret-manager
- @google/generative-ai
- axios
- cors
- dotenv
- firebase-admin
- firebase-functions
- stripe

**devDependencies**
- @types/node
- rimraf
- typescript


---

## Quick curl smoke tests (fill `$BASE` and `$IDTOKEN`)
```bash
# get user profile
curl -sS "$BASE/getUserProfile" -H "Authorization: Bearer $IDTOKEN"

# generate daily challenge
curl -sS -X POST "$BASE/generateDailyChallenge"   -H "Authorization: Bearer $IDTOKEN" -H "Content-Type: application/json"   -d '{}'

# create token checkout
curl -sS -X POST "$BASE/createStripeCheckout"   -H "Authorization: Bearer $IDTOKEN" -H "Content-Type: application/json"   -d '{ "packSize": 50 }'
```

---

## Regenerate
```bash
npm run snapshot
```
